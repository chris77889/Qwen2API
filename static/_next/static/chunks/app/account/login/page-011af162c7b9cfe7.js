(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[326],{5809:function(e,r,t){Promise.resolve().then(t.bind(t,4213))},2372:function(e,r,t){"use strict";t.d(r,{Z:function(){return i}});var s=t(2110),n=t(4090),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"},o=t(688),i=n.forwardRef(function(e,r){return n.createElement(o.Z,(0,s.Z)({},e,{ref:r,icon:a}))})},7907:function(e,r,t){"use strict";var s=t(5313);t.o(s,"usePathname")&&t.d(r,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(r,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(r,{useSearchParams:function(){return s.useSearchParams}}),t.o(s,"useServerInsertedHTML")&&t.d(r,{useServerInsertedHTML:function(){return s.useServerInsertedHTML}})},4213:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return y}});var s=t(3827),n=t(4090),a=t(1945),o=t(8567),i=t(1587),c=t(2110),u={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},l=t(688),d=n.forwardRef(function(e,r){return n.createElement(l.Z,(0,c.Z)({},e,{ref:r,icon:u}))}),m=t(7907),f=t(5175),p=t(9732),h=t(2372),g=t(6541);function P(e){let[r,t]=(0,n.useState)(!1),o=(0,m.useRouter)(),c=(0,m.useSearchParams)().get("redirect"),u=async e=>{t(!0);try{let r=await g.O.validateApiKey(e.apiKey);r.success?(f.ZP.success("登录成功"),o.push(c||"/admin/list")):f.ZP.error(r.error||"登录失败")}catch(e){f.ZP.error((null==e?void 0:e.message)||"登录过程中发生错误")}finally{t(!1)}};return(0,s.jsxs)(a.Z,{name:"login",onFinish:u,layout:"vertical",requiredMark:!1,children:[(0,s.jsx)(a.Z.Item,{name:"apiKey",rules:[{required:!0,message:"请输入API密钥"},{max:50,message:"API密钥不能超过50个字符"}],children:(0,s.jsx)(p.Z,{prefix:(0,s.jsx)(h.Z,{}),placeholder:"API密钥",size:"large",autoComplete:"off"})}),(0,s.jsx)(a.Z.Item,{children:(0,s.jsx)(i.ZP,{type:"primary",htmlType:"submit",size:"large",block:!0,loading:r,children:"登录"})})]})}function y(){let[e,r]=(0,n.useState)(!1),t=(0,m.useRouter)(),[c]=a.Z.useForm(),{isAuthenticated:u}=function(){let[e,r]=(0,n.useState)(!1),[t,s]=(0,n.useState)(!0);return(0,n.useEffect)(()=>{(async()=>{g.O.getApiKey()?r(!0):(s(!1),r(!1))})()},[]),{isAuthenticated:e,isLoading:t}}();return(0,s.jsx)("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,s.jsxs)(o.Z,{style:{minWidth:360,maxWidth:400,width:"100%",borderRadius:8,boxShadow:"0 4px 16px 4px #eaeaec"},bodyStyle:{padding:32},children:[(0,s.jsx)("div",{style:{textAlign:"center",marginBottom:24},children:(0,s.jsxs)("h2",{style:{fontWeight:700,marginBottom:4,color:"#222"},children:[(0,s.jsx)("span",{style:{letterSpacing:3,fontSize:28},children:"Qwen2API"}),(0,s.jsx)("br",{}),u?"欢迎回来":"登录"]})}),u?(0,s.jsxs)("div",{style:{textAlign:"center"},children:[(0,s.jsx)(d,{style:{fontSize:48,color:"#1677ff"}}),(0,s.jsx)("p",{style:{fontSize:16,color:"#333",marginBottom:24},children:"您已成功登录"}),(0,s.jsx)(i.ZP,{type:"primary",size:"large",block:!0,onClick:()=>t.push("/admin/list"),children:"前往管理"})]}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(P,{})}),(0,s.jsx)("div",{style:{borderTop:"1px solid #eee",margin:"20px 0 8px 0",paddingTop:14,textAlign:"center",color:"#aaa"},children:(0,s.jsx)("span",{children:"Qwen2API by fengwind"})})]})})}},4865:function(e,r,t){"use strict";t.d(r,{H:function(){return s},P:function(){return n}});let s={baseURL:t(9079).env.NEXT_PUBLIC_API_BASE_URL||"/"},n={accounts:{login:"/accounts/login",logout:e=>"/accounts/logout/".concat(e),list:"/accounts/list",status:e=>"/accounts/".concat(e,"/status"),commonCookies:"/accounts/common-cookies",refresh:e=>"/accounts/".concat(e,"/refresh")},models:{list:"/models",update:e=>"/models/update/".concat(e)}}},8749:function(e,r,t){"use strict";var s=t(3107),n=t(5175),a=t(3742),o=t(4865),i=t(6541),c=t(2825);let u=s.default.create({baseURL:o.H.baseURL,timeout:3e4,withCredentials:!0,headers:{"Content-Type":"application/json"}});u.interceptors.request.use(async e=>{let r=i.O.getApiKey();return r&&(e.headers.Authorization="Bearer ".concat(r)),e},e=>(n.ZP.error("网络错误"),Promise.reject(new c.a(0,"NETWORK_ERROR","网络错误")))),u.interceptors.response.use(e=>e,async e=>{if(e.response){let{status:r,data:t,config:s}=e.response;console.error("API Error:",{status:r,data:t,url:s.url,method:s.method,params:s.params,requestData:s.data});let n=c.a.fromError(e);switch(r){case 400:a.ZP.error({message:"400 请求参数错误",description:n.message||"请求参数错误"});break;case 403:a.ZP.error({message:"403 禁止访问",description:"禁止访问"});break;case 404:a.ZP.error({message:"404 未找到",description:"未找到"});break;case 422:a.ZP.error({message:"422 请求验证错误",description:n.message||"请求验证错误"});break;case 429:a.ZP.warning({message:"429 请求过多",description:n.message||"请求过多"});break;case 500:a.ZP.error({message:"500 服务器错误",description:"服务器错误"});break;default:a.ZP.error({message:"未知错误",description:n.message||"未知错误"})}throw n}if(e.request)throw console.error("No response received:",e.request),a.ZP.error({message:"网络错误",description:"网络错误"}),new c.a(0,"NETWORK_ERROR","网络错误");throw console.error("Request configuration error:",e.message),a.ZP.error({message:"请求错误",description:"请求错误"}),new c.a(0,"REQUEST_FAILED","请求错误")}),r.Z=u},6541:function(e,r,t){"use strict";t.d(r,{O:function(){return c}});var s=t(4865),n=t(8749),a=t(376),o=t(2825);let i={API_KEY:"qwen_api_key"},c={saveApiKey(e){localStorage.setItem(i.API_KEY,e)},getApiKey:()=>localStorage.getItem(i.API_KEY),async validateApiKey(e){try{let r=await n.Z.get("".concat(s.P.models.list),{headers:{Authorization:"Bearer ".concat(e)}});if(200===r.status)return this.saveApiKey(e),{success:!0};return{success:!1,error:"验证失败"}}catch(e){if(e instanceof o.a)return{success:!1,error:e.message||"API 密钥验证失败"};if(e instanceof a.d7){var r,t,i;if((null===(r=e.response)||void 0===r?void 0:r.status)===403)return{success:!1,error:"API 密钥无效或未授权访问"};return{success:!1,error:(null===(i=e.response)||void 0===i?void 0:null===(t=i.data)||void 0===t?void 0:t.message)||"API 密钥验证失败"}}return{success:!1,error:"验证过程中发生未知错误"}}},async logout(){localStorage.removeItem(i.API_KEY)}}},2825:function(e,r,t){"use strict";t.d(r,{a:function(){return s}});class s extends Error{static fromError(e){if(e.response){var r,t;return new s(e.response.status,(null===(r=e.response.data)||void 0===r?void 0:r.code)||"UNKNOWN_ERROR",(null===(t=e.response.data)||void 0===t?void 0:t.detail)||"未知错误")}return new s(0,"UNKNOWN_ERROR",e.message||"未知错误")}constructor(e,r,t){super(t),this.statusCode=e,this.code=r,this.name="ApiException"}}}},function(e){e.O(0,[587,385,205,518,971,69,744],function(){return e(e.s=5809)}),_N_E=e.O()}]);