(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91],{2845:function(e,r,t){Promise.resolve().then(t.bind(t,4158))},4158:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return L}});var n=t(3827),o=t(4090),i=t(4440),s=t(6169),l=t(9974),a=t(8188),c=t(5334),d=t(3582),u=t(7297),p=t(8807),h=t(311),g=t(7907),f=t(2372),y=t(4523);let m=function e(r,t){return r.map(r=>{var n;let o=null!==(n=r.auth)&&void 0!==n?n:t,i={...r,effectiveAuth:o};return r.children&&(i.children=e(r.children,o)),i})}(function e(r){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return r.map(r=>{let n=r.path||r.key,o=["link","divider","slot"].includes(r.type);"group"===r.type&&(o=!r.routeableForGroup);let i=o?void 0:"".concat(t?t+"/":"/").concat(n).replace(/\/+/g,"/"),s={...r,path:o?void 0:i,key:o?r.key:i};return r.children&&(s.children=e(r.children,null!=i?i:"")),s})}([{key:"admin",label:"管理",icon:(0,n.jsx)(f.Z,{}),order:1,auth:{actions:["accounts:list"]},type:"group",routeableForGroup:!0,noPage:!0,children:[{key:"cookies",label:"公共 Cookie",icon:(0,n.jsx)(y.Z,{}),order:1,type:"item"},{key:"list",label:"账号管理",icon:(0,n.jsx)(f.Z,{}),type:"item",order:2}]}]));function x(e){let r={};return!function e(t,n){for(let o of t)r[o.key]={...o,parent:n},o.children&&e(o.children,o.key)}(e),r}var b=t(1445);let{Sider:v}=i.default;function k(e){let{collapsed:r,isMobile:t=!1,onMenuClick:i,slots:s={}}=e,l=(0,g.useRouter)(),a=(0,g.usePathname)(),c=(0,o.useMemo)(()=>(function e(r,t){return r.filter(e=>!e.hideInMenu).map(r=>r.children?{...r,children:e(r.children,t)}:r).filter(e=>!e.children||e.children.length>0).sort((e,r)=>{var t,n;return(null!==(t=e.order)&&void 0!==t?t:0)-(null!==(n=r.order)&&void 0!==n?n:0)})})(m,{}),[]),d=(0,o.useMemo)(()=>(function e(r,t){return r.map(r=>"group"===r.type?{type:"group",key:r.key,label:r.label,children:r.children?e(r.children,t):[]}:"divider"===r.type?{type:"divider"}:"link"===r.type&&r.url?{key:r.key,icon:r.icon,label:r.label}:"slot"===r.type&&r.slotKey&&t&&t[r.slotKey]?{key:r.key,label:t[r.slotKey],disabled:!0,style:{cursor:"auto",background:"transparent",padding:0}}:{key:r.key,icon:r.icon,label:(0,n.jsx)("a",{href:r.key,style:{color:"inherit",textDecoration:"none"},onClick:e=>{e.metaKey||e.ctrlKey||1===e.button||e.preventDefault()},children:r.label}),children:r.children?e(r.children,t):void 0})})(c,s),[c,s]),u=(0,o.useMemo)(()=>x(m),[]),f=(0,o.useMemo)(()=>(function(e,r){let t=r;for(;t;){let r=e[t];if(r&&"item"===r.type&&!r.noPage)return r.key;if(t.lastIndexOf("/")>0)t=t.substring(0,t.lastIndexOf("/"));else break}return""})(u,a),[a,u]),y=(0,o.useMemo)(()=>f?function(e,r){var t,n;let o=[],i=null===(t=e[r])||void 0===t?void 0:t.parent;for(;i;)o.unshift(i),i=null===(n=e[i])||void 0===n?void 0:n.parent;return o}(u,f):[],[f,u]);return t?null:(0,n.jsxs)(v,{trigger:null,collapsible:!0,collapsed:r,width:220,collapsedWidth:60,style:{boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)",zIndex:10,height:"100vh",position:"fixed",left:0,top:0,overflow:"hidden"},children:[(0,n.jsx)("div",{style:{height:64,display:"flex",alignItems:"center",justifyContent:r?"center":"flex-start",padding:r?"0":"0 16px",borderBottom:"1px solid #f0f0f0"},children:r?(0,n.jsx)(b.Z,{style:{fontSize:20}}):(0,n.jsx)("span",{style:{fontSize:18,fontWeight:600,letterSpacing:3},children:"Qwen2API"})}),0===d.length?(0,n.jsx)("div",{style:{flex:1,display:"flex",justifyContent:"center",alignItems:"center"},children:r?(0,n.jsx)(p.Z,{description:null,image:p.Z.PRESENTED_IMAGE_SIMPLE}):(0,n.jsx)(p.Z,{description:"暂无可用菜单",image:p.Z.PRESENTED_IMAGE_SIMPLE})}):(0,n.jsx)(h.Z,{mode:"inline",selectedKeys:f?[f]:[],defaultOpenKeys:y,items:d,onClick:e=>{let{key:r,domEvent:t}=e,n=u[r];if(n){if("link"===n.type&&n.url){window.open(n.url,"_blank","noopener,noreferrer");return}if(n.noPage||"item"!==n.type){t.preventDefault();return}l.push(r),i&&i()}},style:{borderRight:0,flex:1,background:"transparent",fontWeight:500,fontSize:15,minHeight:"calc(100vh - 65px - 56px)"}})]})}var j=t(9102),w=t.n(j),E=t(6180),P=t(9197),Z=t(7397),I=t(516),R=t(6656),C=t(4848),_=t(6541);let{Header:S}=i.default;function A(e){let{children:r}=e,t=(0,g.useRouter)(),{theme:o,setTheme:i}=(0,C.F)(),{token:l}=s.Z.useToken(),a="dark"===o,c=[{key:"logout",label:"退出登录",icon:(0,n.jsx)(I.Z,{}),onClick:()=>{_.O.logout(),t.push("/account/login"),t.refresh()},danger:!0}];return(0,n.jsxs)(S,{style:{padding:"0 24px",background:l.colorBgContainer,boxShadow:"0 1px 4px rgba(0,0,0,.1)",display:"flex",alignItems:"center",justifyContent:"space-between",zIndex:9},children:[(0,n.jsx)("div",{style:{display:"flex",alignItems:"center"},className:w().dynamic([["ee9b8710879dc233",[l.colorBgTextHover]]]),children:r}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},className:w().dynamic([["ee9b8710879dc233",[l.colorBgTextHover]]]),children:[(0,n.jsx)(E.Z,{title:a?"切换到亮色模式":"切换到暗色模式",children:(0,n.jsx)("div",{onClick:()=>i(a?"light":"dark"),style:{height:40,width:40,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",borderRadius:"50%",transition:"background 0.3s",backgroundColor:"transparent"},className:w().dynamic([["ee9b8710879dc233",[l.colorBgTextHover]]])+" header-icon-btn",children:(0,n.jsx)(R.Z,{style:{fontSize:16}})})}),(0,n.jsx)(P.Z,{menu:{items:c},placement:"bottomRight",trigger:["click"],arrow:!0,children:(0,n.jsx)("div",{style:{height:40,width:40,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",borderRadius:"50%",transition:"background 0.3s",backgroundColor:"transparent"},className:w().dynamic([["ee9b8710879dc233",[l.colorBgTextHover]]])+" header-avatar-container",children:(0,n.jsx)(Z.Z,{icon:(0,n.jsx)(f.Z,{}),style:{backgroundColor:l.colorPrimary},size:"small"})})})]}),(0,n.jsx)(w(),{id:"ee9b8710879dc233",dynamic:[l.colorBgTextHover],children:".header-icon-btn:hover,.header-avatar-container:hover{background-color:".concat(l.colorBgTextHover,"}")})]})}var N=t(4347),K=t(8792);function B(){let e=(0,g.usePathname)(),r=(0,o.useMemo)(()=>x(m),[]),t=[{key:"/",label:"首页",link:"/"},...(0,o.useMemo)(()=>(function(e,r){let t=r,n=e[t];for(;!n||!("item"===n.type||"group"===n.type&&n.routeableForGroup);)if(t.lastIndexOf("/")>0)n=e[t=t.substring(0,t.lastIndexOf("/"))];else{n=void 0;break}let o=[],i=n;for(;i;)o.unshift(i),i=i.parent&&e[i.parent];return o})(r,e),[r,e]).map(e=>({key:e.key,label:(0,n.jsxs)(n.Fragment,{children:[e.icon?(0,n.jsx)("span",{style:{marginRight:4},children:e.icon}):null,e.label]}),link:"item"!==e.type||e.noPage?void 0:e.key}))];return(0,n.jsx)(N.Z,{items:t.map(e=>{let{key:r,label:t,link:o}=e;return o?{title:(0,n.jsx)(K.default,{href:o,children:t})}:{title:t}})})}let{Content:O}=i.default;function L(e){let{children:r,loading:t=!1}=e,[p,h]=(0,o.useState)(()=>window.innerWidth<=768),[g,f]=(0,o.useState)(()=>window.innerWidth<=768),[y,m]=(0,o.useState)(!1),{token:x}=s.Z.useToken();(0,o.useEffect)(()=>{let e=()=>{let e=window.innerWidth<=768;h(e),f(e)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let b=()=>m(!1);return(0,n.jsxs)(i.default,{style:{minHeight:"100vh",position:"relative",flexDirection:"row",background:x.colorBgLayout},children:[(0,n.jsx)(k,{collapsed:g,isMobile:p}),p&&(0,n.jsx)(l.Z,{title:"菜单",placement:"left",onClose:b,open:y,width:220,bodyStyle:{padding:0},children:(0,n.jsx)(k,{collapsed:!1,onMenuClick:b})},"mobile-sidebar"),(0,n.jsxs)(i.default,{style:{marginLeft:p?0:g?60:220,transition:"margin-left 0.2s",willChange:"margin-left",display:"flex",flexDirection:"column",height:"100vh",background:x.colorBgLayout},children:[(0,n.jsxs)("div",{style:{flex:"none"},children:[(0,n.jsx)(A,{children:p?(0,n.jsx)("span",{className:"trigger",onClick:()=>m(!0),style:{cursor:"pointer",fontSize:18},children:(0,n.jsx)(c.Z,{})}):(0,n.jsx)("span",{className:"trigger",onClick:()=>f(!g),style:{cursor:"pointer",fontSize:18},children:g?(0,n.jsx)(d.Z,{}):(0,n.jsx)(u.Z,{})})}),(0,n.jsx)("div",{style:{padding:"12px 24px",background:x.colorBgLayout,borderBottom:"1px solid ".concat(x.colorBorderSecondary)},children:(0,n.jsx)(B,{})})]}),(0,n.jsx)(O,{style:{flex:1,minHeight:0,overflow:"auto",background:x.colorBgLayout},children:(0,n.jsx)("div",{style:{padding:24,minHeight:280,margin:"16px",background:x.colorBgContainer,borderRadius:x.borderRadiusLG,transition:"background 0.2s"},children:t?(0,n.jsx)(a.Z,{active:!0,paragraph:{rows:8}}):r})})]})]})}},4865:function(e,r,t){"use strict";t.d(r,{H:function(){return n},P:function(){return o}});let n={baseURL:t(9079).env.NEXT_PUBLIC_API_BASE_URL||"/"},o={accounts:{login:"/accounts/login",logout:e=>"/accounts/logout/".concat(e),list:"/accounts/list",status:e=>"/accounts/".concat(e,"/status"),commonCookies:"/accounts/common-cookies",refresh:e=>"/accounts/".concat(e,"/refresh")},models:{list:"/models",update:e=>"/models/update/".concat(e)}}},8749:function(e,r,t){"use strict";var n=t(3107),o=t(5175),i=t(3742),s=t(4865),l=t(6541),a=t(2825);let c=n.default.create({baseURL:s.H.baseURL,timeout:3e4,withCredentials:!0,headers:{"Content-Type":"application/json"}});c.interceptors.request.use(async e=>{let r=l.O.getApiKey();return r&&(e.headers.Authorization="Bearer ".concat(r)),e},e=>(o.ZP.error("网络错误"),Promise.reject(new a.a(0,"NETWORK_ERROR","网络错误")))),c.interceptors.response.use(e=>e,async e=>{if(e.response){let{status:r,data:t,config:n}=e.response;console.error("API Error:",{status:r,data:t,url:n.url,method:n.method,params:n.params,requestData:n.data});let o=a.a.fromError(e);switch(r){case 400:i.ZP.error({message:"400 请求参数错误",description:o.message||"请求参数错误"});break;case 403:i.ZP.error({message:"403 禁止访问",description:"禁止访问"});break;case 404:i.ZP.error({message:"404 未找到",description:"未找到"});break;case 422:i.ZP.error({message:"422 请求验证错误",description:o.message||"请求验证错误"});break;case 429:i.ZP.warning({message:"429 请求过多",description:o.message||"请求过多"});break;case 500:i.ZP.error({message:"500 服务器错误",description:"服务器错误"});break;default:i.ZP.error({message:"未知错误",description:o.message||"未知错误"})}throw o}if(e.request)throw console.error("No response received:",e.request),i.ZP.error({message:"网络错误",description:"网络错误"}),new a.a(0,"NETWORK_ERROR","网络错误");throw console.error("Request configuration error:",e.message),i.ZP.error({message:"请求错误",description:"请求错误"}),new a.a(0,"REQUEST_FAILED","请求错误")}),r.Z=c},6541:function(e,r,t){"use strict";t.d(r,{O:function(){return a}});var n=t(4865),o=t(8749),i=t(376),s=t(2825);let l={API_KEY:"qwen_api_key"},a={saveApiKey(e){localStorage.setItem(l.API_KEY,e)},getApiKey:()=>localStorage.getItem(l.API_KEY),async validateApiKey(e){try{let r=await o.Z.get("".concat(n.P.models.list),{headers:{Authorization:"Bearer ".concat(e)}});if(200===r.status)return this.saveApiKey(e),{success:!0};return{success:!1,error:"验证失败"}}catch(e){if(e instanceof s.a)return{success:!1,error:e.message||"API 密钥验证失败"};if(e instanceof i.d7){var r,t,l;if((null===(r=e.response)||void 0===r?void 0:r.status)===403)return{success:!1,error:"API 密钥无效或未授权访问"};return{success:!1,error:(null===(l=e.response)||void 0===l?void 0:null===(t=l.data)||void 0===t?void 0:t.message)||"API 密钥验证失败"}}return{success:!1,error:"验证过程中发生未知错误"}}},async logout(){localStorage.removeItem(l.API_KEY)}}},2825:function(e,r,t){"use strict";t.d(r,{a:function(){return n}});class n extends Error{static fromError(e){if(e.response){var r,t;return new n(e.response.status,(null===(r=e.response.data)||void 0===r?void 0:r.code)||"UNKNOWN_ERROR",(null===(t=e.response.data)||void 0===t?void 0:t.detail)||"未知错误")}return new n(0,"UNKNOWN_ERROR",e.message||"未知错误")}constructor(e,r,t){super(t),this.statusCode=e,this.code=r,this.name="ApiException"}}}},function(e){e.O(0,[587,385,205,610,250,513,971,69,744],function(){return e(e.s=2845)}),_N_E=e.O()}]);