(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[845],{4313:function(e,r,n){Promise.resolve().then(n.bind(n,4386))},4386:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return b}});var t=n(3827),s=n(4090),o=n(5680),i=n(1587),a=n(2503),l=n(5270),c=n(9197),d=n(2212),u=n(3618),m=n(1124);function p(e,r){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3?arguments[3]:void 0,o="function"==typeof e.disabled?e.disabled(r):e.disabled;if(e.render)return(0,t.jsx)("span",{children:e.render(r)},e.key);let l=(0,t.jsx)(i.ZP,{type:e.type,icon:e.icon,danger:e.danger,size:"small",disabled:o,block:n,onClick:n=>{var t;n.stopPropagation(),null===(t=e.onClick)||void 0===t||t.call(e,r),null==s||s()},children:e.text},e.key);if(e.popConfirm){let{title:i,okText:c,cancelText:d,onConfirm:u,onCancel:m,disabled:p}=e.popConfirm,h="function"==typeof p?p(r):p;return n?(0,t.jsx)("div",{style:{width:"100%"},children:(0,t.jsx)(a.Z,{title:"function"==typeof i?i(r):i,okText:null!=c?c:"确定",cancelText:null!=d?d:"取消",onConfirm:n=>{u&&u(r),e.onClick&&e.onClick(r),null==s||s()},onCancel:()=>{null==m||m(r),null==s||s()},disabled:h||o,children:l},e.key)}):(0,t.jsx)(a.Z,{title:"function"==typeof i?i(r):i,okText:null!=c?c:"确定",cancelText:null!=d?d:"取消",onConfirm:n=>{u&&u(r),e.onClick&&e.onClick(r),null==s||s()},onCancel:()=>{null==m||m(r),null==s||s()},disabled:h||o,children:l},e.key)}return n?(0,t.jsx)("div",{style:{width:"100%"},children:l}):l}function h(e){let{dataSource:r,loading:n,columns:o,rowKey:a,pagination:h,actions:g,mobileFixedActionKeys:f=[],onChange:y}=e,v=(0,m.ac)({maxWidth:768}),x=(0,s.useMemo)(()=>o.filter(e=>!!e.mobileShowInMenu),[o]),k=(0,s.useCallback)(e=>x.map(r=>{let n=r.menuLabelRender?r.menuLabelRender(e):r.render?r.render(r.dataIndex?e[r.dataIndex]:void 0,e,0):r.dataIndex?e[r.dataIndex]:null;return{key:"info-"+String(r.key),label:(0,t.jsxs)("div",{style:{fontSize:13,lineHeight:1.6,display:"flex",alignItems:"center"},children:[r.menuIcon&&(0,t.jsx)("span",{style:{marginRight:6,verticalAlign:"middle",display:"inline-flex",alignItems:"center"},children:r.menuIcon}),(0,t.jsxs)("span",{style:{marginRight:6},children:["function"==typeof r.title?r.title({}):r.title,":"]}),(0,t.jsx)("span",{children:null!=n?n:"-"})]})}}),[x]),Z=(0,s.useCallback)(e=>{var r,n;let{record:o}=e,[a,d]=(0,s.useState)(!1),m=(0,s.useMemo)(()=>g?g(o).filter(e=>!("function"==typeof e.hidden?e.hidden(o):e.hidden)).sort((e,r)=>{var n,t;return(null!==(n=e.order)&&void 0!==n?n:100)-(null!==(t=r.order)&&void 0!==t?t:100)}):[],[g,o]);if(!v){let e=m.filter(e=>!1!==e.showInDesktop);return(0,t.jsx)(l.Z,{children:e.map(e=>p(e,o))})}let h=m.filter(e=>!1!==e.showInMobile),y=[],x=[];f&&f.length>0?(y=h.filter(e=>f.includes(e.key)),x=h.filter(e=>!f.includes(e.key))):x=h;let Z=null!==(r=k(o))&&void 0!==r?r:[],j=x.map(e=>{let r=(0,t.jsx)("div",{style:{margin:"-4px -12px",padding:0},onClick:e=>e.stopPropagation(),children:p(e,o,!0,()=>d(!1))});return[e.dividerBefore?{type:"divider"}:void 0,{key:e.key,icon:void 0,label:r,disabled:"function"==typeof e.disabled?e.disabled(o):e.disabled,danger:e.danger,onClick:()=>{if(!e.popConfirm){var r;null===(r=e.onClick)||void 0===r||r.call(e,o),d(!1)}}}].filter(Boolean)}).flat(),C=[...null!=Z?Z:[],(null!==(n=null==Z?void 0:Z.length)&&void 0!==n?n:0)>0&&j.length?{type:"divider"}:null,...j].filter(Boolean);return(0,t.jsxs)(l.Z,{children:[y.map(e=>p(e,o,!1,()=>d(!1))),(0,t.jsx)(c.Z,{trigger:["click"],placement:"bottomRight",open:a,onOpenChange:e=>d(e),menu:{items:C,onClick:e=>{d(!1);let r=x.find(r=>r.key===e.key);r&&!r.popConfirm&&r.onClick&&r.onClick(o)}},children:(0,t.jsx)(i.ZP,{icon:(0,t.jsx)(u.Z,{}),type:"primary",size:"small",children:"更多"})})]})},[g,k,v,f]),j=(0,s.useMemo)(()=>o.map(e=>("action"===e.key||"actions"===e.key)&&g?{...e,render:(e,r)=>(0,t.jsx)(Z,{record:r})}:e),[o,g,Z]);return(0,t.jsx)(d.Z,{columns:j,dataSource:r,rowKey:a,loading:n,pagination:h,scroll:v?{x:"max-content"}:void 0,size:v?"small":"middle",onChange:y})}var g=n(5175),f=n(7628),y=n(1945),v=n(9732),x=n(6992),k=n(4190),Z=n(8543),j=n(9539),C=n.n(j);let P=()=>{let[e,r]=(0,s.useState)([]),[n,a]=(0,s.useState)(!1),[c,d]=(0,s.useState)(null),[u,m]=(0,s.useState)(!1),[p,j]=(0,s.useState)(!1),P=(0,s.useCallback)(async()=>{a(!0);try{let e=await Z.Q.getAccounts();r(e)}catch(e){g.ZP.error("获取账号列表失败")}finally{a(!1)}},[]);(0,s.useEffect)(()=>{P()},[P]);let b=async e=>{try{let r=await Z.Q.login(e);r.success?(g.ZP.success("登录成功"),j(!1),P()):g.ZP.error(r.error||"登录失败")}catch(e){g.ZP.error("登录失败")}},w=async e=>{try{let r=await Z.Q.logout(e);r.success?(g.ZP.success("登出成功"),P()):g.ZP.error(r.error||"登出失败")}catch(e){g.ZP.error("登出失败")}},_=async e=>{try{let{username:r,...n}=e,t=await Z.Q.updateAccountStatus(r,n);t.success?(g.ZP.success("更新状态成功"),m(!1),P()):g.ZP.error(t.error||"更新状态失败")}catch(e){g.ZP.error("更新状态失败")}},I=async e=>{try{let r=await Z.Q.refreshCookie(e);r.success?(g.ZP.success("刷新 Cookie 成功"),P()):g.ZP.error(r.error||"刷新 Cookie 失败")}catch(e){g.ZP.error("刷新 Cookie 失败")}};return(0,t.jsxs)(o.Z,{title:"账号管理",children:[(0,t.jsx)("div",{style:{marginBottom:16},children:(0,t.jsx)(i.ZP,{type:"primary",onClick:()=>j(!0),children:"账号登录"})}),(0,t.jsx)(h,{columns:[{title:"用户名",dataIndex:"username",key:"username"},{title:"状态",dataIndex:"enabled",key:"enabled",render:e=>(0,t.jsx)("span",{style:{color:e?"#52c41a":"#ff4d4f"},children:e?"启用":"禁用"})},{title:"过期时间",dataIndex:"expires_at",key:"expires_at",render:e=>e?C()(1e3*e).format("YYYY-MM-DD HH:mm:ss"):"-"},{title:"操作",key:"action",render:(e,r)=>(0,t.jsxs)(l.Z,{children:[(0,t.jsx)(i.ZP,{type:"link",onClick:()=>w(r.username),children:"登出"}),(0,t.jsx)(i.ZP,{type:"link",onClick:()=>{d(r),m(!0)},children:"修改状态"}),(0,t.jsx)(i.ZP,{type:"link",onClick:()=>I(r.username),children:"刷新 Cookie"})]})}],dataSource:e,loading:n,rowKey:"username"}),(0,t.jsx)(f.Z,{title:"修改账号状态",open:u,onCancel:()=>m(!1),footer:null,children:(0,t.jsxs)(y.Z,{initialValues:{username:null==c?void 0:c.username,enabled:null==c?void 0:c.enabled,expires_at:(null==c?void 0:c.expires_at)?C()(c.expires_at):void 0},onFinish:_,children:[(0,t.jsx)(y.Z.Item,{name:"username",hidden:!0,children:(0,t.jsx)(v.Z,{})}),(0,t.jsx)(y.Z.Item,{label:"启用状态",name:"enabled",children:(0,t.jsx)(x.Z,{})}),(0,t.jsx)(y.Z.Item,{label:"过期时间",name:"expires_at",children:(0,t.jsx)(k.Z,{showTime:!0})}),(0,t.jsx)(y.Z.Item,{children:(0,t.jsx)(i.ZP,{type:"primary",htmlType:"submit",children:"确认"})})]})}),(0,t.jsx)(f.Z,{title:"账号登录",open:p,onCancel:()=>j(!1),footer:null,children:(0,t.jsxs)(y.Z,{onFinish:b,layout:"vertical",children:[(0,t.jsx)(y.Z.Item,{label:"用户名",name:"username",rules:[{required:!0,message:"请输入用户名"}],children:(0,t.jsx)(v.Z,{placeholder:"请输入用户名"})}),(0,t.jsx)(y.Z.Item,{label:"密码",name:"password",rules:[{required:!0,message:"请输入密码"}],children:(0,t.jsx)(v.Z.Password,{placeholder:"请输入密码"})}),(0,t.jsx)(y.Z.Item,{children:(0,t.jsx)(i.ZP,{type:"primary",htmlType:"submit",block:!0,children:"登录"})})]})})]})};function b(){return(0,t.jsx)(P,{})}},5680:function(e,r,n){"use strict";var t=n(3827),s=n(4090),o=n(6169),i=n(8188),a=n(8567),l=n(9519),c=n.n(l);r.Z=e=>{let{title:r,subTitle:n,extra:l,children:d,loading:u,footer:m,style:p,className:h="",showHeader:g=!0,contentCard:f=!0}=e,{token:y}=o.Z.useToken(),v=(0,s.useMemo)(()=>u?(0,t.jsx)(i.Z,{active:!0,title:!0,paragraph:!1,style:{width:180,height:38,margin:"8px 0"}}):r&&(0,t.jsx)("h1",{style:{fontSize:y.fontSizeHeading3,fontWeight:600,margin:0},children:r}),[u,r,y.fontSizeHeading3]),x=(0,s.useMemo)(()=>u&&n?(0,t.jsx)(i.Z,{active:!0,title:!1,paragraph:{rows:1,width:"60%"},style:{marginTop:y.marginXS}}):n&&(0,t.jsx)("div",{style:{color:y.colorTextSecondary,marginTop:y.marginXS},children:n}),[u,n,y.colorTextSecondary,y.marginXS]);return(0,t.jsxs)("div",{style:{backgroundColor:"transparent",...p},className:h,children:[g&&(r||n||l)&&(0,t.jsxs)("div",{style:{marginBottom:y.marginLG,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,t.jsxs)("div",{children:[v,x]}),l&&(0,t.jsx)("div",{children:u?null:l})]}),(0,t.jsx)("div",{className:c().pageContainerContent,children:f?(0,t.jsx)(a.Z,{bodyStyle:{padding:0},loading:u,children:d}):u?(0,t.jsx)(i.Z,{active:!0,paragraph:{rows:8}}):d}),m&&(0,t.jsx)("div",{style:{marginTop:y.marginLG},children:u?(0,t.jsx)(i.Z,{active:!0,paragraph:{rows:1,width:["40%"]}}):m})]})}},4865:function(e,r,n){"use strict";n.d(r,{H:function(){return t},P:function(){return s}});let t={baseURL:n(9079).env.NEXT_PUBLIC_API_BASE_URL||"/"},s={accounts:{login:"/accounts/login",logout:e=>"/accounts/logout/".concat(e),list:"/accounts/list",status:e=>"/accounts/".concat(e,"/status"),commonCookies:"/accounts/common-cookies",refresh:e=>"/accounts/".concat(e,"/refresh")},models:{list:"/models",update:e=>"/models/update/".concat(e)}}},8749:function(e,r,n){"use strict";var t=n(3107),s=n(5175),o=n(3742),i=n(4865),a=n(6541),l=n(2825);let c=t.default.create({baseURL:i.H.baseURL,timeout:3e4,withCredentials:!0,headers:{"Content-Type":"application/json"}});c.interceptors.request.use(async e=>{let r=a.O.getApiKey();return r&&(e.headers.Authorization="Bearer ".concat(r)),e},e=>(s.ZP.error("网络错误"),Promise.reject(new l.a(0,"NETWORK_ERROR","网络错误")))),c.interceptors.response.use(e=>e,async e=>{if(e.response){let{status:r,data:n,config:t}=e.response;console.error("API Error:",{status:r,data:n,url:t.url,method:t.method,params:t.params,requestData:t.data});let s=l.a.fromError(e);switch(r){case 400:o.ZP.error({message:"400 请求参数错误",description:s.message||"请求参数错误"});break;case 403:o.ZP.error({message:"403 禁止访问",description:"禁止访问"});break;case 404:o.ZP.error({message:"404 未找到",description:"未找到"});break;case 422:o.ZP.error({message:"422 请求验证错误",description:s.message||"请求验证错误"});break;case 429:o.ZP.warning({message:"429 请求过多",description:s.message||"请求过多"});break;case 500:o.ZP.error({message:"500 服务器错误",description:"服务器错误"});break;default:o.ZP.error({message:"未知错误",description:s.message||"未知错误"})}throw s}if(e.request)throw console.error("No response received:",e.request),o.ZP.error({message:"网络错误",description:"网络错误"}),new l.a(0,"NETWORK_ERROR","网络错误");throw console.error("Request configuration error:",e.message),o.ZP.error({message:"请求错误",description:"请求错误"}),new l.a(0,"REQUEST_FAILED","请求错误")}),r.Z=c},8543:function(e,r,n){"use strict";n.d(r,{Q:function(){return i}});var t=n(4865),s=n(8749),o=n(376);let i={async login(e){try{return await s.Z.post(t.P.accounts.login,e),{success:!0}}catch(e){if(e instanceof o.d7){var r,n;return{success:!1,error:(null===(n=e.response)||void 0===n?void 0:null===(r=n.data)||void 0===r?void 0:r.message)||"登录失败"}}return{success:!1,error:"登录失败"}}},async logout(e){try{return await s.Z.post(t.P.accounts.logout(e)),{success:!0}}catch(e){if(e instanceof o.d7){var r,n;return{success:!1,error:(null===(n=e.response)||void 0===n?void 0:null===(r=n.data)||void 0===r?void 0:r.message)||"登出失败"}}return{success:!1,error:"登出失败"}}},getAccounts:async()=>(await s.Z.get(t.P.accounts.list)).data,async updateAccountStatus(e,r){try{return await s.Z.post(t.P.accounts.status(e),r),{success:!0}}catch(e){if(e instanceof o.d7){var n,i;return{success:!1,error:(null===(i=e.response)||void 0===i?void 0:null===(n=i.data)||void 0===n?void 0:n.message)||"更新账号状态失败"}}return{success:!1,error:"更新账号状态失败"}}},getCommonCookies:async()=>(await s.Z.get(t.P.accounts.commonCookies)).data.data,async updateCommonCookies(e){try{let r=JSON.parse(e);return await s.Z.post(t.P.accounts.commonCookies,{cookies:r}),{success:!0}}catch(e){if(e instanceof o.d7){var r,n;return{success:!1,error:(null===(n=e.response)||void 0===n?void 0:null===(r=n.data)||void 0===r?void 0:r.message)||"更新公共 Cookie 失败"}}return{success:!1,error:"更新公共 Cookie 失败"}}},async refreshCookie(e){try{return await s.Z.post(t.P.accounts.refresh(e)),{success:!0}}catch(e){if(e instanceof o.d7){var r,n;return{success:!1,error:(null===(n=e.response)||void 0===n?void 0:null===(r=n.data)||void 0===r?void 0:r.message)||"刷新 Cookie 失败"}}return{success:!1,error:"刷新 Cookie 失败"}}}}},6541:function(e,r,n){"use strict";n.d(r,{O:function(){return l}});var t=n(4865),s=n(8749),o=n(376),i=n(2825);let a={API_KEY:"qwen_api_key"},l={saveApiKey(e){localStorage.setItem(a.API_KEY,e)},getApiKey:()=>localStorage.getItem(a.API_KEY),async validateApiKey(e){try{let r=await s.Z.get("".concat(t.P.models.list),{headers:{Authorization:"Bearer ".concat(e)}});if(200===r.status)return this.saveApiKey(e),{success:!0};return{success:!1,error:"验证失败"}}catch(e){if(e instanceof i.a)return{success:!1,error:e.message||"API 密钥验证失败"};if(e instanceof o.d7){var r,n,a;if((null===(r=e.response)||void 0===r?void 0:r.status)===403)return{success:!1,error:"API 密钥无效或未授权访问"};return{success:!1,error:(null===(a=e.response)||void 0===a?void 0:null===(n=a.data)||void 0===n?void 0:n.message)||"API 密钥验证失败"}}return{success:!1,error:"验证过程中发生未知错误"}}},async logout(){localStorage.removeItem(a.API_KEY)}}},2825:function(e,r,n){"use strict";n.d(r,{a:function(){return t}});class t extends Error{static fromError(e){if(e.response){var r,n;return new t(e.response.status,(null===(r=e.response.data)||void 0===r?void 0:r.code)||"UNKNOWN_ERROR",(null===(n=e.response.data)||void 0===n?void 0:n.detail)||"未知错误")}return new t(0,"UNKNOWN_ERROR",e.message||"未知错误")}constructor(e,r,n){super(n),this.statusCode=e,this.code=r,this.name="ApiException"}}},9519:function(e){e.exports={"page-container":"PageContainer_page-container__F2_vX",mobile:"PageContainer_mobile__HDFuu","mobile-content":"PageContainer_mobile-content__QrMA_","page-container-content":"PageContainer_page-container-content__jmDFL"}}},function(e){e.O(0,[587,385,205,518,610,212,245,633,971,69,744],function(){return e(e.s=4313)}),_N_E=e.O()}]);